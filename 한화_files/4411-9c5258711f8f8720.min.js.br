"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="9287a61b-ea62-53bc-93e1-42a667689146")}catch(e){}}();
(globalThis.webpackChunk_figma_web_bundler=globalThis.webpackChunk_figma_web_bundler||[]).push([["4411"],{367578(e,t,r){r.d(t,{e:()=>s});let s="https://go/figmascope-docs"},730395(e,t,r){r.d(t,{rf:()=>i,tV:()=>o,zG:()=>n});var s=r(239976),a=r(432819);function n(){return(0,s.jsx)(o,{children:(0,s.jsx)("p",{children:"Reading file..."})})}function i({error:e}){let t="Oops! Something went wrong";return"string"==typeof e?t=e:e instanceof Error&&(t=e.message,console.error(e)),(0,s.jsx)(o,{children:(0,s.jsx)("p",{style:a.sx.colorTextOndanger.colorBgDanger.p16.font20.maxW400.$,children:t})})}function o({children:e}){return(0,s.jsx)("div",{style:a.sx.fillPositionedContainer.flex.itemsCenter.justifyCenter.flexColumn.lh1_5Lines.font16.$,children:e})}},498418(e,t,r){let s;r.d(t,{J:()=>tm});var a=r(239976),n=r(105652),i=r(800674),o=r(759231),l=r(32186),c=r(715993),d=r(878725),u=r(710652),h=r(432819),f=r(957292),p=r(692567),g=r(148688),m=r(245694),b=r(75488),x=r(14190),y=r(696801);let v=(0,o.eU)(e=>{let t=e(b.OC);return"fullscreen"===t.view?`/api/file/scenegraph_validations/${t.fileKey}`:(0,x.E)(t)&&t.urlParams?.type==="server_file"?`/api/admin/scenegraph_validations/${t.urlParams.key}`:null}),k=(0,o.eU)(e=>null!=e(v)),j=(s=(0,o.eU)((0,g.Ok)()),(0,o.eU)(e=>e(s),async(e,t)=>{let r;if(e(s).status===u.r.LOADING)return;let a=e(v);if(a){t(s,(0,g.ux)());try{r=await C(a)}catch(e){t(s,(0,g.uW)(e));return}t(s,(0,g.NY)(r))}}));async function C(e){let t=await (0,m.GD)(e),r=new y._;for(let e of t.data.meta.data.results.violations)if("always-fail-for-testing"!==e.name)for(let t of e.instances)r.add(t.guid,t.message);return r}var w=r(936779),S=r(953386),I=r(730395),T=r(174822),_=r(980973),N=r(787049),E=r(297746),M=r(677394),A=r(163423),O=r.n(A),D=r(263618),P=r(596035),F=r(292008);let $=(0,S.Sv)("bookmarkSettings",{bookmarks:{}}),L=(0,o.eU)(e=>{let t=e($),r=e(p.Cc).id;return new Set((t.bookmarks[r]??[]).map(e=>e.id))});function z(){let[e,t]=(0,o.fp)($),r=(0,o.md)(p.Cc).id,s=n.useCallback(s=>{t({...e,bookmarks:{...e.bookmarks,[r]:s(e.bookmarks[r]||[])}})},[e,r,t]),a=n.useCallback((e,t)=>{s(r=>[...r,{id:e,name:t}])},[s]),i=n.useCallback(e=>{s(t=>t.filter((t,r)=>r!==e))},[s]),l=n.useCallback((e,t)=>{s(r=>r.map((r,s)=>s===e?{...r,name:t}:r))},[s]),c=n.useCallback((e,t)=>{s(r=>r.map((r,s)=>s===e?{...r,id:F.SW.fromString(t)}:r))},[s]),d=n.useCallback(e=>{s(t=>{if(e>=t.length-1)return t;let r=t.slice(),[s]=r.splice(e,1);return r.splice(e+1,0,s),r})},[s]);return{addBookmark:a,deleteBookmark:i,moveBookmarkDown:d,moveBookmarkUp:n.useCallback(e=>{s(t=>{if(e<=0)return t;let r=t.slice(),[s]=r.splice(e,1);return r.splice(e-1,0,s),r})},[s]),renameBookmark:l,updateBookmarkId:c,bookmarks:n.useMemo(()=>e.bookmarks[r]||[],[e,r])}}var R=r(45512);function U(e,t,r){return[...e.getObject(r)?.mapDescendants(e=>e.id)??[],...t?.getObject(r)?.mapDescendants(e=>e.id)??[]]}let B=(0,o.FZ)((0,o.eU)({}),(e,t,r)=>{let s=r(p.Cc),a=r(p.lX);switch(t.type){case"toggleExpanded":return(0,R.X9)(e,t.objectId,t.toggleSubtree?U(s,a,t.objectId):[]);case"expandAncestors":var n;return(0,R.nE)(e,(n=t.objectId,[...s.getObject(n)?.mapAncestors(e=>e.id)??[],...a?.getObject(n)?.mapAncestors(e=>e.id)??[]]),!0);case"expandDescendants":return(0,R.nE)(e,[t.objectId,...U(s,a,t.objectId)],!0);case"collapseDescendants":return(0,R.IO)(e,[t.objectId,...U(s,a,t.objectId)])}});var H=r(60021),K=r(449979),G=r(281442);let V=(0,o.eU)({status:"initial"}),q=(0,o.eU)(0),J=(0,o.eU)(!1),X=(0,o.eU)(e=>{if(e(J)){let t=e(q);return`Indexing search results (this may take a moment)... [${t}/???]`}return null}),Y=(0,S.Sv)("searchMode",S.Y6.Search),W=(0,o.eU)(e=>{let t=e(V),r=e(p.Cc),s=e(w.Sd);return"initial"===t.status?s.map(e=>r.getObject(e)).filter(K.Vq).map(e=>({object:e,matches:[]})).reverse():"results"in t&&t.results.length>0?t.results:null}),Q=(0,o.eU)(e=>{let t=e(V);if("searching"===t.status&&0===t.results.length){let t=["Searching..."],r=e(X);return r&&t.push(r),t}if("success"===t.status&&0===t.results.length){let t=["No results found."],r=e(p.Cc);return r instanceof G.G2&&t.push("Some content may be unavailable because of incremental loading"),"hide"===r.sensitiveTextPolicy&&t.push("Searching text fields is limited beacuse text redaction has been applied."),t}return"error"===t.status?["Error searching:",String(t.error)]:null}),Z=(0,o.eU)(e=>{if(e(Y)!==S.Y6.Filter)return null;let t=e(V);return"results"in t?t.results.map(e=>e.object):null}),ee=(0,o.eU)(e=>{if(e(Y)!==S.Y6.Filter)return null;let t=e(Q);return t?t.join(" "):null}),et=(0,S.Sv)("sortOrder",S.hX.Position),er=(0,o.eU)(e=>{let t=[S.hX.Position,S.hX.Name,S.hX.NodeId];return e(p.Cc).rootObjects[0]?.displayProperties.memoryFraction!=null&&t.push(S.hX.Memory),t.sort(),t}),es=(0,o.eU)(e=>{switch(e(et)){case S.hX.Position:return en;case S.hX.Name:return ea;case S.hX.Memory:return eo;case S.hX.NodeId:return ei}});function ea(e,t){return e.displayProperties.name.localeCompare(t.displayProperties.name)}function en(e,t){let[r,s]=el(e,t);if(r&&s){let e=r.parentIndex?.position,t=s.parentIndex?.position;if(null==e&&null==t)return 0;if(null==t)return 1;if(null==e)return -1;else if(e<t)return -1;else if(e>t)return 1}return ea(e,t)}function ei(e,t){let[r,s]=el(e,t);if(r&&s){let{sessionID:e,localID:t}=r.guid??{localID:-1,sessionID:-1},{sessionID:a,localID:n}=s.guid??{localID:-1,sessionID:-1};return e-a||t-n}return en(e,t)}function eo(e,t){return(t.displayProperties.memoryFraction??0)-(e.displayProperties.memoryFraction??0)||en(e,t)}function el(e,t){return"nodeChange"in e&&"nodeChange"in t?[e.nodeChange,t.nodeChange]:[null,null]}var ec=r(950730),ed=r(366110),eu=r(417675),eh=r(701045),ef=r(867760),ep=r(844715),eg=r(404988);let em=ef.ms,eb=ef.c$,ex=ef.wv;function ey({contextMenuData:{objectId:e,position:t},onClose:r}){let[s,i]=n.useState(0),l=t.left,c=t.top+s>window.innerHeight?t.top-s:t.top,{canSelectInApp:d,selectInApp:u}=n.useContext(w.H$),g=n.useRef(null);(0,eh.ww)(g,r);let m=(0,o.md)(p.Cc).getObject(e),b=m instanceof eg.R?m:null,x=m instanceof ep.E?m:null,[y,v]=(0,o.fp)(f.Oz),k=(0,o.Xr)(B);if(null==m)return null;let j=e=>()=>{e(),r()},C=m.children.length>0,S=(()=>{if(d?.(m))return j(()=>u(m))})(),I=e=>j(()=>E.glU?.triggerAction(e,{guid:m.id})),T=y?.object.id===m.id;return(0,a.jsx)(em,{style:{...h.sx.fixed.$,left:l,top:c},dropdownRef:e=>{e&&i(e.clientHeight)},children:(0,a.jsxs)("div",{ref:g,children:[S&&(0,a.jsx)(eb,{onClick:S,children:"Jump to node"}),C&&(0,a.jsx)(eb,{onClick:j(()=>k({type:"expandDescendants",objectId:e})),children:"Expand descendants"}),C&&(0,a.jsx)(eb,{onClick:j(()=>k({type:"collapseDescendants",objectId:e})),children:"Collapse descendants"}),(S||C)&&(0,a.jsx)(ex,{}),T&&(0,a.jsx)(eb,{onClick:j(()=>v({type:"clear"})),children:"Stop diffing against this node"}),(!T||y?.type!==f.Lp.Layer)&&(0,a.jsx)(eb,{onClick:j(()=>v({type:"start",diffType:f.Lp.Layer,id:e})),children:"Layer diff against this node"}),(!T||y?.type!==f.Lp.Tree)&&(0,a.jsx)(eb,{onClick:j(()=>v({type:"start",diffType:f.Lp.Tree,id:e})),children:"Tree diff against this node"}),b&&(0,a.jsx)(ex,{}),b&&(0,a.jsx)(eb,{onClick:j(()=>{let e=JSON.stringify(b.nodeChange,null,2);navigator.clipboard.writeText(e)}),children:"Copy NodeChange JSON"}),x&&"DOCUMENT"!==x.type&&"CANVAS"!==x.type&&(0,a.jsx)(eb,{onClick:I("debug-print-as-test-code"),children:(0,eu.tx)("fullscreen_actions.debug-print-as-test-code")}),x&&"VECTOR"===x.type&&(0,a.jsx)(eb,{onClick:I("debug-print-vector-network-as-test-code"),children:(0,eu.tx)("fullscreen_actions.debug-print-vector-network-as-test-code")})]})})}var ev=r(723698);let ek=n.memo(function({diffType:e,id:t,primaryId:r,secondaryId:s,leftBadges:i,indent:o,index:l,isExpanded:c,isLeaf:d,isSelected:u,isSelectedSecondary:h,memoryFraction:f,rightBadges:p,name:g,style:m,select:b,toggle:x,showContextMenu:y}){let v=n.useCallback(e=>{e.preventDefault(),y({objectId:t,position:{left:e.clientX,top:e.clientY}})},[t,y]);return(0,a.jsxs)(ev.Z,{changeType:e,indent:o,isExpanded:c,isLeaf:d,isSelected:u,isSelectedSecondary:h,keyboardNavigationPath:[l],onContextMenu:v,onMouseEnter:()=>{E.Ez5&&E.Ez5.editorState().figmaScopeHighlightedNode.set(t)},onMouseLeave:()=>{E.Ez5&&E.Ez5.editorState().figmaScopeHighlightedNode.set("")},select:()=>b(t),style:m,toggleExpanded:e=>x(t,e),children:[(0,a.jsx)(ec.IV,{badges:i}),(0,a.jsx)(ed.nK,{id:r}),s&&(0,a.jsx)(ed.nK,{id:s,secondary:!0}),(0,a.jsx)("div",{title:g,className:D.s.ellipsis.noWrap.overflowHidden.$,children:g}),(0,a.jsx)(P.M,{}),(0,a.jsx)(ec.IV,{badges:p}),null!=f&&(0,a.jsxs)("span",{className:D.s.colorTextSecondary.$,title:"Node memory usage",children:[(100*f).toFixed(3),"%"]})]})});function ej({style:e,data:{displayedObjects:t,selectedId:r,selectedIds:s,...n},index:i}){let o=t[i],l=(0,M.zN)(e);return(0,a.jsx)(ek,{...o,...n,isSelected:r===o.id,isSelectedSecondary:!!o&&s.includes(o.id),style:l,index:i})}let eC=[];function ew({appSelection:e}){let t=(0,o.md)(eS),[r,s]=(0,o.fp)(w.AJ),i=(0,M.k9)(()=>e?.guids??eC,[e?.guids]),[l,c]=n.useState(null),d=n.useRef(null);n.useEffect(()=>{let e=t.findIndex(e=>e.id===r);e>=0&&d.current?.scrollToItem(e,"smart")},[t,r]);let u=(0,o.Xr)(B);n.useEffect(()=>{u({type:"expandAncestors",objectId:r})},[u,r]);let h=n.useCallback((e,t)=>{u({type:"toggleExpanded",objectId:e,toggleSubtree:t})},[u]),f=(0,o.md)(ee);return 0===t.length?(0,a.jsx)("div",{children:f??"Empty Scene"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(T.A,{disableWidth:!0,children:({height:e})=>(0,a.jsx)(_.Y1,{itemSize:18,itemCount:t.length,height:e,ref:d,itemData:{displayedObjects:t,selectedId:r,selectedIds:i,select:s,toggle:h,showContextMenu:c},width:"100%",children:ej})}),l&&(0,a.jsx)(ey,{contextMenuData:l,onClose:()=>{c(null)}})]})}let eS=(0,o.eU)(e=>{let t=e(L),r=e(p.Cc);return(e(eI)??e(eT)).map(e=>({...e,rightBadges:[...e.rightBadges,...t.has(e.id)?[{type:"bookmark",value:"Bookmarked"}]:[],...r.getAdditionalBadges?.(e.id)||[]]}))}),eI=(0,o.eU)(e=>{let t=e(Z);return t?t.map(e=>({...e.displayProperties,diffType:void 0,id:e.id,indent:0,isExpanded:!1,isLeaf:!0})):null}),eT=(0,o.eU)(e=>{let t=e(p.Cc).rootObjects,r=e(f.sg),s=e(B),a=e(es),n=(()=>{switch(r.type){case f.Lp.Tree:return[r.object];case f.Lp.Full:return r.resource.rootObjects;default:return[]}})(),i={sortFn:a,expandedIds:s};return O()(t,e=>{if(!e)return[];if(0===n.length)return e_(e,0,i);let t=eE(e,n);return t?eN(e,t,0,i):function e(t,r,s,a){let n=t.id,i=t.children,o=0===i.length,l=!!a.expandedIds[n],c=!1,d=O()(i,t=>{let n=(()=>{let n=eE(t,r);if(n)return eN(t,n,s+1,a);let i=r.filter(e=>e.someAncestor(e=>e.id===t.id,{includeSelf:!0}));return i.length>0?e(t,i,s+1,a):e_(t,s+1,a)})();return c=c||n[0]?.diffType!=null,n}),u={...t.displayProperties,diffType:c?"CHILD_MODIFIED":void 0,id:n,indent:s,isExpanded:l,isLeaf:o};return l?[u,...d]:[u]}(e,n,0,i)})});function e_(e,t,r){let s=e.id,a=e.children,n=0===a.length,i=!!r.expandedIds[s],o={...e.displayProperties,diffType:void 0,id:s,indent:t,isExpanded:i,isLeaf:n};return i?[o,...O()(eM(a,r.sortFn),e=>e_(e,t+1,r))]:[o]}function eN(e,t,r,s){let a=e??t;if(!a)throw Error("Diffing two nothings");if(e&&t&&e.id!==t.id)throw Error("Diffing nodes with mismatched keys");let n=a.id,i=eM(e?.children??[],s.sortFn),o=eM(t?.children??[],s.sortFn),l=(0,N.TR)(i,o,e=>e.id),c=!1,d=O()(l,({left:e,right:t})=>{let a=eN(e,t,r+1,s);return c=c||a[0]?.diffType!=null,a}),u=(0,f.wc)(e,t,c),h=e?.displayProperties.name,p=t?.displayProperties.name,g=null!=h&&null!=p&&h!==p?`${h} <=> ${p}`:a.displayProperties.name,m=!!s.expandedIds[n],b={...a.displayProperties,diffType:u,id:n,indent:r,isExpanded:m,isLeaf:0===l.length,name:g};return m?[b,...d]:[b]}function eE(e,t){return t.find(t=>t.id===e.id)}function eM(e,t){return e.slice().sort(t)}var eA=r(470683),eO=r(751239),eD=r(507187);r(323264);var eP=r(28550),eF=r(336435),e$=r(464466),eL=r(870948),ez=r(491285),eR=r(582746),eU=r(773583),eB=r(682864),eH=r(260587),eK=r(563225);function eG(e){let{bookmarks:t,deleteBookmark:r,moveBookmarkDown:s,moveBookmarkUp:i,renameBookmark:o,updateBookmarkId:l}=z();return(0,a.jsx)(eP.bL,{defaultPosition:{x:window.innerWidth/2,y:window.innerHeight/2},onClose:e.onClose,width:400,children:(0,a.jsxs)(eF.vo,{children:[(0,a.jsx)(eF.Y9,{children:(0,a.jsx)(eF.hE,{children:"FigmaScope Bookmarks"})}),(0,a.jsx)(eF.nB,{children:(0,a.jsxs)(e$.bL,{...{className:"xrvj5dj x1nfngrj"},children:[0===t.length&&(0,a.jsx)("div",{className:"x6s0dn4 x78zum5 xpyat2d xl56j7k",children:"No bookmarks"}),t.length>0&&(0,a.jsxs)(eL.fI,{...{className:"xrvj5dj xuhvigx xg2d0mh"},children:[(0,a.jsx)(ez.fh,{children:"Name"}),(0,a.jsx)(ez.fh,{children:"ID"})]}),t.map((e,c)=>(0,n.createElement)(eL.fI,{className:"xrvj5dj xuhvigx xg2d0mh",key:c},(0,a.jsx)(ez.fh,{children:(0,a.jsx)(eR.p,{id:`edit-bookmark-name-${c}`,value:e.name,onChange:e=>o(c,e)})}),(0,a.jsx)(ez.fh,{children:(0,a.jsx)(eR.p,{id:`edit-bookmark-id-${c}`,value:e.id,onChange:e=>l(c,e)})}),(0,a.jsx)(ez.fh,{children:(0,a.jsxs)(eU.e,{"aria-label":`Bookmark actions for ${e.name}`,children:[(0,a.jsx)(eO.K,{"aria-label":"Delete bookmark",onClick:()=>r(c),children:(0,a.jsx)(eB.i,{})}),(0,a.jsx)(eO.K,{"aria-label":"Move bookmark up",disabled:0===c,onClick:()=>i(c),children:(0,a.jsx)(eH.t,{})}),(0,a.jsx)(eO.K,{"aria-label":"Move bookmark down",disabled:c===t.length-1,onClick:()=>s(c),children:(0,a.jsx)(eK.O,{})})]})})))]})})]})})}function eV(){let[e,t]=(0,o.fp)(w.AJ),r=(0,o.md)(w.gg),{getTriggerProps:s,manager:i}=eA.b(),{addBookmark:l,bookmarks:c}=z(),[d,u]=n.useState(!1);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(eA.bL,{manager:i,children:[(0,a.jsx)("div",{...{className:"xrybvsa"},children:(0,a.jsx)(eO.K,{...s(),"aria-label":"bookmarks",children:(0,a.jsx)(eD.j,{})})}),(0,a.jsxs)(eA.mc,{children:[(0,a.jsxs)(eA.YJ,{title:(0,a.jsx)(eA.r1,{children:"Bookmark settings"}),children:[(0,a.jsx)(eA.q7,{onClick:()=>{let t=r?.displayProperties.name??"Bookmark";l(e,`${t} - ${e}`)},children:"Add bookmark"}),(0,a.jsx)(eA.q7,{onClick:()=>{u(!0)},children:"Manage bookmarks"})]}),c.length?(0,a.jsx)(eA.YJ,{title:(0,a.jsx)(eA.r1,{children:"Bookmark list"}),children:c.map((e,r)=>(0,a.jsx)(eA.q7,{onClick:()=>{t(e.id)},children:e.name},r))}):null]})]}),d&&(0,a.jsx)(eG,{onClose:()=>u(!1)})]})}var eq=r(224542),eJ=r.n(eq),eX=r(460860),eY=r(485036);function eW({searchRef:e}){let t=(0,o.Xr)(w.AJ),r=(0,o.md)(W),s=(0,o.md)(Q),[i,l]=n.useState(!1),c=(0,o.md)(Y)!==S.Y6.Filter&&i,d=n.useRef(null);(0,eh.ww)(d,()=>l(!1));let u=n.useCallback(e=>{l(!1),t(e.object.id)},[l,t]);return(0,a.jsxs)(eY.dP,{className:D.s.flex1.$,ref:d,allowVim:!0,children:[(0,a.jsx)(eQ,{searchRef:e,setShowSearchResults:l}),c&&(r?(0,a.jsx)(e0,{searchResults:r,selectResult:u}):s?(0,a.jsx)(e1,{text:s}):null)]})}function eQ({searchRef:e,setShowSearchResults:t}){let r,s,i,l,c,d,u=(0,o.md)(Y),h=(r=(0,o.md)(p.Cc),s=(0,o.Xr)(V),i=(0,o.Xr)(q),l=(0,o.Xr)(J),c=n.useRef(0),d=n.useMemo(()=>(0,H.s)(e=>{let t=++c.current;l(!0);let a=new TaskController({priority:"user-visible"});scheduler.postTask(()=>l(!0),{signal:a.signal,delay:300}).catch(()=>{});let n=r.getObject(e);n&&s({status:"searching",results:[{object:n,matches:[{value:e,property:"id",isExact:!0}]}]}),r.getSearch(i).then(t=>t.searchWithText(e)).then(e=>{a.abort(),t===c.current&&s({status:"success",results:e})}).catch(e=>{console.error(e),a.abort(),t===c.current&&s({status:"error",error:e})})},200),[r,i,s,l]),n.useCallback(e=>0===e.length?s({status:"initial"}):d(e),[d,s])),{setKeyboardNavigationElement:f}=(0,eY.M3)({path:[0,0],id:"input"});return(0,a.jsx)("input",{ref:t=>{f(t),e.current=t},type:"text",placeholder:u,className:"search_bar--searchBar--UMQA-",onChange:e=>h(e.target.value),onFocus:()=>t(!0)})}function eZ({children:e}){return(0,a.jsx)("div",{className:D.s.absolute.zIndexModal.colorBg.b1.colorBorder.mt2.overflowAuto.$,style:{maxHeight:450,minWidth:500,boxShadow:"0px 2px 14px var(--color-shadow, rgba(0, 0, 0, 0.15))"},children:e})}function e0({searchResults:e,selectResult:t}){return(0,a.jsx)(eZ,{children:e.map((e,r)=>(0,a.jsx)(e5,{result:e,index:r,onClick:()=>t(e)},e.object.id))})}function e1({text:e}){return(0,a.jsx)(eZ,{children:(Array.isArray(e)?e:[e]).map((e,t)=>(0,a.jsx)("div",{className:D.s.colorBg.colorTextSecondary.px8.py4.$,children:e},t))})}function e5({result:e,index:t,onClick:r}){let{object:s,matches:i}=e,{displayProperties:o}=s,{setKeyboardNavigationElement:l,keyboardNavigationItem:c,isFauxFocused:d}=(0,eY.M3)({path:[1,t],id:s.id});return n.useEffect(()=>{c&&0===t&&c.fauxFocus()},[c,t]),(0,a.jsx)("button",{ref:l,className:eJ()(D.s.block.wFull.px4.py8.colorText.flex.itemsCenter.alignLeft.$,"search_bar--searchResult--8iGr1",d&&"search_bar--fauxFocus--6i7Gb"),onClick:r,children:(0,a.jsxs)(P.Y,{spacing:4,children:[(0,a.jsx)(ec.IV,{badges:o.leftBadges}),(0,a.jsx)(ed.nK,{id:s.displayProperties.primaryId}),(0,a.jsx)(eX.R,{className:D.s.overflowHidden.$,text:o.name}),(0,a.jsx)(P.M,{}),i.filter(({property:e})=>!["id","guid","name","type","phase"].includes(e)).map(({property:e,value:t},r)=>(0,a.jsxs)(P.Y,{spacing:4,width:"hug-contents",children:[(0,a.jsxs)("div",{children:[e,":"]}),(0,a.jsx)("div",{children:t})]},r))]})})}var e2=r(556486);function e4({children:e}){return(0,a.jsx)("div",{className:D.s.colorBorder.px8.py4.bb1.bSolid.$,children:(0,a.jsx)(P.Y,{children:e})})}function e6(e){let t={className:"toolbar_components--iconButton--h3x8J",children:(0,a.jsx)(e2.B,{svg:e.svg}),title:e.label,"aria-label":e.label};return"href"in e?(0,a.jsx)("a",{...t,href:e.href,target:"blank"}):(0,a.jsx)("button",{...t,onClick:e.onClick,disabled:e.disabled})}var e7=r(691109),e3=r(176346);function e9({searchRef:e}){let[t,r]=(0,o.fp)(w.jI),[s,i]=(0,o.fp)(w.JN),c=!!n.useContext(w.H$).selectInApp,[d,u]=(0,o.fp)(Y),[h,f]=(0,o.fp)(w.bA),[p,g]=(0,o.fp)(et),m=(0,o.md)(er);return(0,a.jsxs)(e4,{children:[(0,a.jsx)(eW,{searchRef:e}),(0,a.jsxs)("select",{name:"filter-or-search",title:"Determines whether the text box searches or filters",onChange:e=>{u(e.target.value)},defaultValue:d,children:[(0,a.jsx)("option",{value:S.Y6.Search,children:"Search"}),(0,a.jsx)("option",{value:S.Y6.Filter,children:"Filter"})]}),(0,a.jsx)("select",{name:"sort",title:"Sets the left panel sort order",onChange:e=>{let t=e.target.value;l.az.trackDefinedEvent("figmascope.sort_order_change",{order:function(e){switch(e){case S.hX.Position:return"position";case S.hX.Name:return"name";case S.hX.Memory:return"memory";case S.hX.NodeId:return"node_id"}}(t)}),g(t)},defaultValue:p,children:m.map(e=>(0,a.jsxs)("option",{value:e,children:["Sort by ",e]},e))}),c&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{name:"follow-selection",type:"checkbox",checked:h,onChange:e=>f(e.target.checked)}),(0,a.jsx)("label",{htmlFor:"follow-selection",children:"Follow"})]}),(0,a.jsx)(e6,{label:"Select Previous",onClick:()=>{r(),l.az.trackDefinedEvent("figmascope.select_prev_next",{direction:"prev",source:"button"})},disabled:!t,svg:e7.A}),(0,a.jsx)(e6,{label:"Select Next",onClick:()=>{i(),l.az.trackDefinedEvent("figmascope.select_prev_next",{direction:"next",source:"button"})},disabled:!s,svg:e3.A}),(0,a.jsx)(eV,{})]})}var e8=r(478602),te=r(341381),tt=r(208916),tr=r(367578),ts=r(135546),ta=r(551683),tn=r(35401),ti=r(217169);function to({selectedObject:e,diffObject:t,onClose:r}){let s=(0,o.md)(k),[n,i]=(0,o.fp)(f.Oz);return(0,a.jsxs)(e4,{children:[e?n&&t?(0,a.jsx)(td,{selectedObject:e,diffObject:t,diffState:n,setDiffState:i}):(0,a.jsx)(tc,{object:e}):t?(0,a.jsx)(tc,{object:t}):(0,a.jsx)(P.M,{}),s&&(0,a.jsx)(tu,{}),(0,a.jsx)(e6,{label:"Help",href:tr.e,svg:ts.A}),r&&(0,a.jsx)(e6,{label:"Close FigmaScope",onClick:r,svg:ti.A})]})}let tl=D.s.flex1.ml10.my4.$;function tc({object:e}){return(0,a.jsx)("div",{className:tl,children:(0,a.jsx)("span",{className:D.s.fontSemiBold.$,children:e.displayProperties.longName})})}function td({selectedObject:e,diffObject:t,diffState:r,setDiffState:s}){let n=(0,o.Xr)(w.AJ);return(0,a.jsxs)("div",{className:D.s.flex1.ml10.my4.$,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:D.s.colorTextSecondary.$,children:"Diffing "}),(0,a.jsx)("span",{className:D.s.fontSemiBold.$,children:e.displayProperties.longName}),(0,a.jsx)("span",{className:D.s.colorTextSecondary.$,children:" against "}),(0,a.jsx)("span",{className:D.s.fontSemiBold.$,children:t.displayProperties.longName})]}),r&&(0,a.jsx)("div",{className:D.s.colorTextSecondary.mt8.$,children:(0,a.jsxs)(P.Y,{spacing:8,width:"hug-contents",height:"hug-contents",verticalAlignItems:"start",children:[(0,a.jsxs)("span",{children:["Snapshot of"," ",(0,a.jsx)(tt.CY,{onClick:()=>n(r.object.id),className:D.s.colorTextFigjam.fontSemiBold.$,trusted:!0,children:r.object.displayProperties.name}),r.type===f.Lp.Tree&&" and full subtree"," was taken at"," ",r.time.toLocaleTimeString("en-US")]}),(0,a.jsx)(tt.CY,{onClick:()=>s({type:"refresh"}),className:D.s.colorTextDesign.$,trusted:!0,children:"Refresh"}),(0,a.jsx)(tt.CY,{onClick:()=>s({type:"clear"}),className:D.s.colorTextDanger.$,trusted:!0,children:"Finish"})]})})]})}function tu(){let[e,t]=(0,o.fp)(j),r=e.status===u.r.LOADING;return n.useEffect(()=>{t()},[t]),(0,a.jsx)(e6,{label:r?"Fetching scene graph validation failures":"Refetch scenegraph validation failures",onClick:t,svg:r?ta.A:tn.A})}var th=r(559381);function tf({children:e}){return(0,a.jsx)("div",{className:D.s.hFull.$,children:(0,a.jsxs)(P.Y,{direction:"vertical",width:"fill-parent",height:"fill-parent",padding:0,spacing:0,children:[(0,a.jsx)(tp,{}),e]})})}function tp(){let{name:e,metadata:t}=(0,o.md)(p.Cc);return(0,a.jsxs)(P.Y,{direction:"horizontal",width:"fill-parent",height:32,padding:8,spacing:32,backgroundColor:"toolbar",children:[e&&(0,a.jsx)(th.E,{fontWeight:"bold",color:"toolbar",children:e}),t&&Object.entries(t).map(([e,t])=>t&&(0,a.jsxs)("span",{children:[(0,a.jsxs)(th.E,{color:"toolbar-secondary",children:[e,": "]}),(0,a.jsx)(th.E,{color:"toolbar",fontFamily:"monospace",fontWeight:"bold",children:t})]},e))]})}var tg=r(275581);let tm=n.memo(function({embedded:e=!1,emptyStateContent:t,onClose:r,appSelection:s,setAppSelection:n}){let i=(0,o.md)(p.lu);switch(i.status){case u.r.INIT:return t??(0,a.jsx)(I.zG,{});case u.r.LOADING:return(0,a.jsx)(I.zG,{});case u.r.FAILURE:return(0,a.jsx)(I.rf,{error:i.error});case u.r.SUCCESS:}if(0===i.value.primaryResource.rootObjects.length)return(0,a.jsx)(I.rf,{error:"No root objects found. This is likely a bug - please report in #figmascope."});let l=(0,a.jsx)(tb,{appSelection:s,setAppSelection:n,onClose:r});return e?l:(0,a.jsx)(tf,{children:l})});function tb({onClose:e,appSelection:t,setAppSelection:r}){let s=n.useRef(null),g=n.useRef(null),{windowInnerWidth:m}=(0,c.l)(),[b,x]=(0,o.fp)(tx),[y,v]=(0,o.fp)(ty),[k,C]=(0,i.i)({onDrag(e){let t=e.clientX/m;x(`${(100*t).toFixed(2)}%`)}}),[S,I]=(0,i.i)({onDrag(e){let t=g.current;if(!t)return;let r=(e.clientX-t.getBoundingClientRect().left)/t.clientWidth;v(`${(100*r).toFixed(2)}%`)}}),T=(0,o.Xr)(w.jI),_=(0,o.Xr)(w.JN),N=n.useCallback(e=>{let t=s.current;document.activeElement!==t&&(e.keyCode===d.Uz.FORWARD_SLASH&&t?(t.focus(),e.preventDefault()):e.keyCode===d.Uz.BRACKET_LEFT?(l.az.trackDefinedEvent("figmascope.select_prev_next",{direction:"prev",source:"keyboard"}),T()):e.keyCode===d.Uz.BRACKET_RIGHT&&(l.az.trackDefinedEvent("figmascope.select_prev_next",{direction:"next",source:"keyboard"}),_()))},[T,_]),E=(0,o.md)(p.Cc);window.figmaScope=E,window.figmaScopeScene=E,function(e){let[t,r]=(0,o.fp)(j);t.status===u.r.SUCCESS&&e?.setSceneGraphValidationInfo?.(t.value),(0,n.useEffect)(()=>{r()},[r])}(E);let M=(0,o.md)(w.AJ),A=(0,o.md)(w.gg),O=(0,o.md)(f.tH);return(0,a.jsx)(w.q,{appSelection:t,setAppSelection:r,children:(0,a.jsxs)("div",{className:tg.zr,style:h.sx.if(k||S,{cursor:"ew-resize"}).$,onKeyDown:N,children:[(0,a.jsxs)("div",{className:tg.Pd,style:{width:b},children:[(0,a.jsx)(e9,{searchRef:s}),(0,a.jsxs)(e8.o,{className:tg._H,children:[(0,a.jsx)("div",{...C({style:{position:"absolute",top:0,bottom:0,right:"-3px",width:"5px",gridArea:"center",cursor:"ew-resize",zIndex:9}})}),(0,a.jsx)(ew,{appSelection:t})]})]}),(0,a.jsxs)("div",{className:tg.io,children:[(0,a.jsx)(to,{selectedObject:A,diffObject:O,onClose:e}),(A||O)&&(0,a.jsxs)("div",{className:tg._t,ref:g,children:[(0,a.jsxs)(e8.o,{className:tg.S3,style:{width:y},children:[(0,a.jsx)("div",{...I({style:{position:"absolute",top:0,bottom:0,right:"-3px",width:"5px",gridArea:"center",cursor:"ew-resize",zIndex:9}})}),(0,a.jsx)(te.P,{panel:"middle",items:A?.rawProperties,diffItems:O?.rawProperties,extraItems:void 0},M)]}),(0,a.jsx)(e8.o,{className:tg.xK,children:(0,a.jsx)(te.P,{panel:"right",items:A?.computedProperties,diffItems:O?.computedProperties,extraItems:E.getAdditionalProperties?.(M)},M)})]})]})]})})}let tx=(0,S.Sv)("leftPanelWidth","35%"),ty=(0,S.Sv)("rightPanelWidth","50%")},577890(e,t,r){r.d(t,{BP:()=>u,_J:()=>c,xO:()=>l});var s=r(291061),a=r(407449),n=r(49952),i=r(245694),o=r(950937);let l=(e,t)=>async r=>{if(!e){let e="Thread ID is required to upload tool result to blob store";return(0,n.fL)(new n.fC(e),"upload_to_blob_store",{fileKey:t}),{state:"uploadFailed",error:e}}let s=await o.M.uploadJsonBlobs(t,e,[r]);if(s.success){let a=s.resultItems[0];if(!a){let r="Blobstore upload succeeded but no result was returned";return(0,n.fL)(new n.fC(r),"upload_to_blob_store",{fileKey:t,threadId:e}),{state:"uploadFailed",error:r}}return(0,n.pF)("Uploaded tool result to blob store",a),{state:r.success?"success":"toolFailed",blobstoreContentKey:a.contentKey}}{let r=`Failed to upload tool result to blob store: ${s.error}`;return(0,n.fL)(new n.fC(r),"upload_to_blob_store",{fileKey:t,threadId:e}),{state:"uploadFailed",error:r}}},c=({fileKey:e,threadId:t,userFlow:r})=>async a=>{let i=await r.measureDurationAsync("uploadContentToBlobstore",async r=>{let s=await o.M.uploadBlobs(e,t,a);return r.addContext({statusCode:s.success?"200":"500",aiChatThreadId:t}),s});if(!i.success)return(0,n.fL)(new n.Tv(`Failed to upload content to blobstore: ${i.error}`),"upload_to_blob_store",{fileKey:e,threadId:t,cause:i.error}),i;let l=i.resultItems.length,c=i.resultItems.filter(e=>e.entityAlreadyExisted).length;return(0,n.nH)(`Uploaded ${l} items to Blobstore (${c} already existed)`,i),r.addAction("uploadedToBlobstore",s.$b.INFO,{numUploaded:l,numAlreadyExisted:c}),i};async function d(e){let t,r;try{let s=await i.Ay.crossOriginGet(e,null,{responseType:"blob",retryCount:2});200===s.status?t=s.data:r=s.cause??Error(`Failed to fetch blob (${s.status}): ${s.data}`)}catch(e){r=e instanceof Error?e:Error(String(e))}return{blob:t,error:r}}let u=new a.X(o.M,(e,t)=>(0,n.fL)(e,"ai_chat_blobstore_cache",t),d,n.nH)},587947(e,t,r){r.d(t,{q:()=>d});var s=r(291061),a=r(865297),n=r(49952),i=r(982021),o=r(865985),l=r(73593);let c=new a.f,d=(0,l.nh)(async e=>{let{fileKey:t,context:r,plan:a}=e,l="ai_assistant"===r?n.fC:n.Tv,d=a.planRecordId;if(!d){let e="No plan record id, cannot create thread";return(0,n.fL)(new l(e),"create_thread_record",{fileKey:t}),{status:"error",error:e}}let u=async()=>{let a=i.J.createVital(`${r}.chat_sdk.thread_creation_time`,{level:s.$b.INFO});a.start();let c=await (0,n.kA)(a,()=>o.NH.createThread({fileKey:t,threadType:"ai_assistant"===r?"assistant":void 0,planId:d,privacyMode:"code_chat"===r?"file":"user",nodeGuid:"code_chat"===r?e.nodeGuid:void 0}));if(a.stop(),!c.success){let{statusCode:e,cause:r,errorData:s}=c,a=`ApiAiChat.createThread failed, status: ${e}`;return(0,n.fL)(new l(a),"create_thread_record",{fileKey:t,statusCode:e,cause:r,errorData:s}),{status:"error",error:a}}return c.data.meta.alreadyExists,{status:"created",threadId:c.data.meta.threadId}};if("code_chat"!==r)return await u();{let s=`${t}:${r}:${e.nodeGuid}`;return await c.run(s,u)}})},332591(e,t,r){r.d(t,{Sw:()=>m,bg:()=>y,bz:()=>C,cD:()=>j,dJ:()=>b,p:()=>v,qM:()=>k,th:()=>x});var s=r(105652),a=r(667104),n=r(323522),i=r(672785),o=r(759231),l=r(49952),c=r(296039),d=r(376750),u=r(945013),h=r(44811),f=r(306874);if(1464==r.j)var p=r(513294);function g(e){return s.useMemo(()=>"errors"!==e.status?[]:e.errors.filter(e=>!e.retriable),[e.status,e.errors])}function m({isEnabled:e,fileKey:t,nodeGuid:r}){let a=(0,h.iZ)(),n=e&&t&&r&&a,i=(0,c.Rs)((0,f.Zrv)(n?{ownerId:t,nodeGuid:r}:null)),o=i.data?.nodeAiChatThreads?.[0]??null,d=g(i);return s.useEffect(()=>{e&&0!==d.length&&(0,l.fL)(new l.Tv("Errors occurred while querying Livegraph NodeAiChatThreadsView"),"nodeaichatthreadsview_initial_view_fail",{subscriptionErrors:JSON.stringify(d),fileKey:t,nodeGuid:r})},[e,d,t,r]),{threadId:o?.id??null,subscriptionStatus:i.status,latestUserMessage:o?.latestUserMessage??null}}function b(e,t,r,a,n){let i=(0,c.Rs)((0,f.r3i)(e?{ownerId:e}:null)),o=g(i);s.useEffect(()=>{0!==o.length&&(0,l.fL)(new l.fC("Errors occurred while querying Livegraph FileAiChatThreadsView"),"fileaichatthreadsview_initial_view_fail",{subscriptionErrors:JSON.stringify(o),fileKey:e})},[o,e]);let d=i.data?.fileAiChatThreads?.[0]?.id??null,u="loaded"!==i.status,[h,p]=s.useState(null),m=h??d,b=e&&m?{ownerId:e,id:m}:null,y=(0,c.Rs)((0,f.A6w)(b)),v=y.data?.activeAiChatThread??null;return s.useEffect(()=>{if(!v||!m||n)return;let e=v.messages.map(x);p(e=>(e!==m&&(0,l.pF)(`Livegraph threadId updating: ${e} => ${m}`),m));let s=a();e.length>s.length+t&&((0,l.pF)("LiveGraph ActiveAiChatThread updating =>",e),r(e))},[v,a,r,m,t,n,p]),{threadId:n?null:m,setThreadId:p,isLoadingThreadId:u}}function x(e){let t=(e.parts??[]).map(({partType:e,contentPb:t,isContentCompressed:r,blobstoreContentKey:s})=>{if(!(0,a.pQ)(e))return(0,l.D5)(`Unknown message part type when converting Livegraph message to AiChatMessage: ${e}. This part will be ignored.`),null;let{type:i,...o}=(0,a.H)(e,t,{isContentCompressed:(0,d.oA)(r)??!1});return(0,n.N)({type:i,contentJson:o,blobstoreContentKey:s})}).filter(e=>null!==e);return(0,i.O)({id:e.id,role:e.role,index:"messageIndex"in e?e.messageIndex:void 0,content:t,createdAtMs:e.createdAt.getTime(),clientId:e.clientId??void 0,userId:"user"in e?e.user?.id??void 0:void 0,guid:"nodeGuid"in e?e.nodeGuid??void 0:void 0,scenegraphSentAt:"scenegraphSentAt"in e?e.scenegraphSentAt??void 0:void 0,makeVersion:(()=>{if(!("makeVersion"in e))return;let t=(0,d.oA)(e.makeVersion);if(t)return{id:t.id,versionNumber:parseInt(t.versionNumber),title:t.title??void 0,codeSnapshotKey:t.codeSnapshotKey??void 0,createdAt:t.createdAt}})()})}let y=200;function v({chatMessagesNode:e,disabled:t}){let r=(0,o.md)(u.ze),s=!t&&r&&e,{threadId:a,subscriptionStatus:n}=m({isEnabled:!!s,fileKey:r,nodeGuid:e?.guid||""}),i=(0,c.Rs)((0,f.nmx)(!t&&s&&a?{ownerId:r,id:a,firstPageSize:y}:null));return{thread:i.data?.activeAiChatThread??null,subscriptionStatus:i.status??n}}let k={numberOfMessages:0,lastMessageUpdatedAt:new Date(0),lastMessageId:"",lastMakeVersionId:null};function j(e){let t=e.length,r=e[t-1],s=null;if((0,p.F)())for(let t=e.length-1;t>=0;t--){let r=e[t];if(!r)continue;let a=(0,d.oA)(r.makeVersion);if(a){s=a.id;break}}return{numberOfMessages:t,lastMessageUpdatedAt:r?.updatedAt??new Date(0),lastMessageId:r?.id??"",lastMakeVersionId:s}}function C(e,t){return null!=e&&null!=t&&e.numberOfMessages===t.numberOfMessages&&e.lastMessageUpdatedAt.getTime()===t.lastMessageUpdatedAt.getTime()&&e.lastMessageId===t.lastMessageId&&e.lastMakeVersionId===t.lastMakeVersionId}},926710(e,t,r){r.d(t,{LT:()=>u,_W:()=>c,lV:()=>d});var s=r(759231),a=r(49952),n=r(764330);if(1464==r.j)var i=r(132414);let o={messages:[]},l=(0,n.H)(o);function c(e,t,r){if(!(0,i.z)("make_chat_sdk_read"))return void d(e);let n=s.zl.get(l(e)).messages;n.length>0&&(0,a.D5)("Appending to pending chat messages before LiveGraph confirmation",{nodeGuid:e,threadId:r??"unknown",existingPendingCount:n.length,newMessageCount:t.length,totalPendingCount:n.length+t.length}),s.zl.set(l(e),{messages:[...n,...t]})}function d(e,t){if(void 0===t)return void s.zl.set(l(e),o);let r=s.zl.get(l(e)).messages.slice(t);s.zl.set(l(e),{messages:r})}function u(e){return(0,s.md)(l(e)).messages}},579073(e,t,r){r.d(t,{H:()=>s});class s{constructor(){this.listeners=new Map}on(e,t){return this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t),()=>{this.listeners.get(e)?.delete(t)}}emit(e){let t=this.listeners.get(e.type);t&&t.forEach(t=>{t(e)})}clear(){this.listeners.clear()}}},103670(e,t,r){if(r.d(t,{y:()=>a}),1464==r.j)var s=r(579073);class a extends(1464==r.j?s.H:null){}},766866(e,t,r){r.d(t,{KF:()=>m,YP:()=>b,di:()=>y,qD:()=>x});var s=r(105652),a=r(968922),n=r(577890),i=r(587947);if(1464==r.j)var o=r(659997);var l=r(332591),c=r(49952),d=r(945013);if(1464==r.j)var u=r(930501);var h=r(454811);if(1464==r.j)var f=r(132414);if(1464==r.j)var p=r(957716);if(1464==r.j)var g=r(412534);function m({chatMessagesNode:e,disabled:t}){let r=(0,d.q5)(),p=r?.key??null,m=!!r?.canEdit;e=t?null:e,s.useEffect(()=>{p&&n.BP.clearCacheIfFileKeyChanged(p)},[p]);let{status:b,data:x}=(0,h.Vc)(p),y="loaded"===b,v=(0,g.gO)(e),k=!!(y&&x&&r&&function(e){switch(e.editorType){case u._Y.FIGMAKE:return!0;case u._Y.SITES:case u._Y.DESIGN:return(0,f.z)("make_chat_sdk_sites_and_design");default:return!1}}(r)&&(0,o.G)(x)),{chatSdkState:j,chatSdkStatus:C}=function({fileKey:e,userCanEditFile:t,shouldQueryChatSdkState:r,chatMessagesNode:a,plan:n}){let o=s.useRef(!1),d=a?.guid||"",{threadId:u,subscriptionStatus:h}=(0,l.Sw)({isEnabled:!!(r&&e&&d),fileKey:e,nodeGuid:d}),f=s.useRef(e),p=s.useRef(d),[g,m]=s.useState({threadId:u,errorOnCreateThread:!1}),b=null!==u&&u!==g?.threadId,x=e!==f.current||d!==p.current;(b||x)&&(f.current=e,p.current=d,m({threadId:u,errorOnCreateThread:!1}));let y=e&&d&&"loaded"===h&&n&&r,v=y&&!t&&null===u;return y&&null===u&&t&&!o.current&&(o.current=!0,(0,i.q)({context:"code_chat",fileKey:e,plan:n,nodeGuid:d}).then(e=>{if("error"===e.status&&m({threadId:null,errorOnCreateThread:!0}),"created"===e.status){let{threadId:t}=e;(0,c.nH)(`Figmake AiChatThread created, id: ${t}`),m({threadId:t,errorOnCreateThread:!1})}})),s.useMemo(()=>{let{threadId:e,errorOnCreateThread:t}=g,r=h;return(t?r="errors":v&&(r="disabled"),e)?{chatSdkState:{threadId:e},chatSdkStatus:r}:{chatSdkState:void 0,chatSdkStatus:r}},[g,h,v])}({fileKey:p,userCanEditFile:m,chatMessagesNode:e,plan:x,shouldQueryChatSdkState:k}),w=k&&"errors"!==C&&"disabled"!==C,S=(0,g.eW)(e,p,j?.threadId??null),I=w&&(0,f.z)("make_chat_sdk_read");return s.useMemo(()=>{let t=I?S:v,r=[v];w&&r.push(S);let s={readingSource:t,writingSinks:r,isInitialized:!!(y&&e&&(!w||j)),node:e,chatSdkState:j,chatSdkPhase1Enabled:w,nodeChatSource:v};return new a.F1(s)},[e,v,S,I,j,w,y])}function b({overrideCodeLibraryNode:e,disabled:t}){let r=(0,p.hk)();return m({chatMessagesNode:void 0!==e?e:r,disabled:t})}function x({codeFileNode:e,disabled:t}){return m({chatMessagesNode:e,disabled:t})}function y({codeFileNode:e,disabled:t}){return m({chatMessagesNode:e,disabled:t})}},412534(e,t,r){r.d(t,{CQ:()=>w,HL:()=>_,eW:()=>T,gO:()=>j});var s=r(105652),a=r(968922),n=r(534399),i=r(988083),o=r(274950),l=r(833994),c=r(759231),d=r(32186),u=r(577890),h=r(332591),f=r(926710),p=r(49952),g=r(376750),m=r(572273),b=r(798882),x=r(764330);if(1464==r.j)var y=r(132414);let v="null-hash",k=(0,x.H)({hash:v,messages:[]});function j(e){let t=e?.guid||"",[r,a]=(0,c.fp)(k(t)),n=(0,c.Pj)(),o=s.useMemo(()=>!!(e&&r.hash!==v),[r.hash,e]),l=s.useCallback(()=>{e&&a({hash:e.chatMessagesHash??v,messages:e.chatMessages_DEPRECATED||[]})},[e,a]),d=(0,b.$I)((e,t)=>t?.chatMessagesHash??v,e);s.useEffect(()=>{e&&d&&d!==r.hash&&l()},[l,e,d,r.hash,t]);let u=s.useCallback(()=>n.get(k(t)).messages??[],[n,t]),h=s.useCallback((r,s,a)=>{if(!o||!e)return;C("appendChatMessages",s,u());let i=(0,m.r)(()=>e.appendChatMessages(r));if(!i.success)throw(0,p.fL)(new p.Tv("appendChatMessages failed in C++"),"chat_controller_append_messages",{nodeGuid:t,error:i.error}),new p.Tv(`appendChatMessages failed in C++: ${i.error}`);n.set(k(t),{hash:i.chatMessagesHash,messages:[...i.existing,...i.appended]})},[o,e,n,t,u]),f=s.useCallback((r,s)=>{if(!o||!e||0===r.length)return;C("editChatMessages",s,u()),(0,i.z7)(r);let a=(0,m.r)(()=>e.editChatMessages(r));if(!a.success)throw(0,p.fL)(new p.Tv("editChatMessages failed in C++"),"chat_controller_edit_messages",{nodeGuid:t,error:a.error}),new p.Tv(`editChatMessages failed in C++: ${a.error}`);n.set(k(t),{hash:a.chatMessagesHash,messages:a.updatedMessages})},[o,e,n,t,u]);return s.useMemo(()=>({getMessages:u,appendMessages:h,editMessages:f,SLOW_populateNodeChatCache:l,isInitialized:o}),[u,h,f,l,o])}function C(e,t,r){if(t.flushFileSeqNum<0)throw new p.Tv(`${e}: flushFileSeqNum must be >= 0`);if(!t.dbCommitFirst&&null!==t.lastDbMessage){let s=t.lastDbMessage.index+1,n=r.length,i={commitContext:e,flushFileSeqNum:t.flushFileSeqNum,dbLength:s,scenegraphLength:n};if(n<s?((0,p.D5)("Scenegraph is behind the database",i),d.az.trackDefinedEvent("chat_sdk.validate_before_commit.scenegraph_behind",i)):n>s?d.az.trackDefinedEvent("chat_sdk.validate_before_commit.scenegraph_ahead",i):d.az.trackDefinedEvent("chat_sdk.validate_before_commit.scenegraph_in_sync",i),t.lastDbMessage&&n>0){let e=n-1,s=r[e];if(!s)return;let o=(0,a._$)(s),l=t.lastDbMessage.uniqueId;e===t.lastDbMessage.index&&o!==l&&((0,p.D5)("Tail mismatch: last SG message differs from last DB message",{...i,lastDbMessageUniqueId:l,lastSgMessageUniqueId:o}),d.az.trackDefinedEvent("chat_sdk.validate_before_commit.tail_mismatch",{...i,lastDbMessageUniqueId:l,lastSgMessageUniqueId:o}))}}}function w(e){return(0,c.md)(k(e)).hash!==v}let S=(0,x.H)({messages:[]}),I=(0,x.H)({messages:[]});function T(e,t,r){let a=e?.guid||"",n=function(e,t,r){let a=e?.guid||"",[n,i]=(0,c.fp)(S(a)),d=(0,f.LT)(a),m=s.useRef(h.qM),b=!(0,y.z)("make_chat_sdk_read")&&(0,y.z)("make_chat_sdk_client_shadow_reads_v2"),x=((0,y.z)("make_chat_sdk_read")||(0,y.z)("make_chat_sdk_client_shadow_reads_v2"))&&e,{thread:v,subscriptionStatus:k}=(0,h.p)({chatMessagesNode:e,disabled:!x}),j=(0,g.oA)(v?.messageCount),C=s.useMemo(()=>[...v?.paginatedMessages??[]].reverse(),[v]),w=(0,y.z)("make_chat_sdk_read")&&void 0!==j&&j>0&&0===n.messages.length,I="loaded"!==k,T=I||w,_=s.useMemo(()=>!!(!x||v&&!T),[x,v,T]);s.useEffect(()=>{if(I||!v||!t||!r)return;if(b)return void(0,p.nH)("[Shadow read] Received LiveGraph data (not used for display)",{threadId:v.id,messageCount:C.length});let e=(0,h.cD)(C);if(!(0,h.bz)(e,m.current)){let s=C.map(h.th);i({messages:s}),m.current=e,(0,p.nH)("[Pre-blobstore] Updated local cache with AiChatMessages",{thread:v,aiChatMessages:s}),(0,o.V)({aiChatMessages:s,partTypesToHydrate:l.NE,shouldHydrateToolCallback:l.eY,blobstoreCache:u.BP,threadId:r,fileKey:t,logWarn:p.D5}).then(({aiChatMessages:t,numHydratedRefParts:r})=>{r>0?(i({messages:t}),m.current=e,(0,p.nH)("[Post-blobstore] Updated local cache with hydrated AiChatMessages",{aiChatMessages:t,numHydratedRefParts:r})):(0,p.nH)("No ref parts to hydrate, skipping re-render")}).catch(e=>{(0,p.nH)("Error hydrating chat messages from blobstore",e),m.current=h.qM})}},[v,I,i,C,t,r,a,b]);let N=s.useMemo(()=>{if(0===d.length)return n.messages;let e=n.messages[n.messages.length-1],t=e?.createdAtMs;if(!t)return[...n.messages,...d];let r=0;for(r=0;r<d.length;r++){let e=d[r];if(!e?.createdAtMs||e.createdAtMs>t)break}r>0&&(0,f.lV)(a,r);let s=d.slice(r);return 0===s.length?n.messages:[...n.messages,...s]},[n.messages,d,a]),E=s.useCallback(()=>N,[N]),M=s.useCallback(()=>{},[]),A=s.useCallback((e,t,r)=>{},[]),O=s.useMemo(()=>{if(!(0,y.z)("make_chat_sdk_read"))return;let e=v?.paginatedMessages,t=!!(T||e?.isLoadingNextPage);return{loadNextPage:t=>{e&&((0,p.nH)("Loading next page of messages",{count:t??h.bg}),e.loadNext(t??h.bg))},hasMore:e?.hasNextPage()??!1,isLoading:t,totalCount:j}},[v,T,j]);return s.useMemo(()=>({getMessages:E,editMessages:M,appendMessages:A,isInitialized:_,pagination:O}),[E,M,A,_,O])}(e,t,r),i=n.getMessages(),[d,m]=(0,c.fp)(I(a)),b=s.useMemo(()=>!!n.isInitialized&&(!(i.length>0)||0!==d.messages.length),[n.isInitialized,i.length,d.messages.length]);s.useEffect(()=>{if(0===i.length)return;let e=i.map(o.Y);m({messages:e}),(0,p.nH)("Set NodeChat cache with converted AiChatMessages",{aiChatMessages:i,convertedMessages:e})},[i,m]);let x=s.useCallback(()=>d.messages,[d.messages]),v=s.useCallback(()=>{},[]),k=s.useCallback((e,t,r)=>{},[]),j=s.useMemo(()=>{if(!n.pagination)return;let e=n.pagination.isLoading||!b;return{...n.pagination,isLoading:e}},[n.pagination,b]);return s.useMemo(()=>({getMessages:x,editMessages:v,appendMessages:k,isInitialized:b,pagination:j}),[x,v,k,b,j])}function _(e){let t=e?.getMessages();return s.useMemo(()=>t?(0,n.Qf)((0,a.BM)(t),!1):[],[t])}},404827(e,t,r){if(r.d(t,{B5:()=>i,PK:()=>o,WR:()=>l}),1464==r.j)var s=r(572827);var a=r(824203),n=r(650266);function i(e){return(0,s.yS)(e)}function o(e){let t=l(),r=(0,n.fF)()??null;return t&&r?(0,s.yS)(`${e}${t}${r}`):null}function l(){return(0,a.default)().user_data?.id??null}},744356(e,t,r){r.d(t,{Fq:()=>I,tT:()=>S,Ay:()=>T});var s=r(105652),a=r(25378),n=r(738864),i=r(836848),o=r(798913),l=r(270450),c=r(759231),d=r(32186),u=r(303293),h=r(945013),f=r(324738),p=r(622179),g=r(867206),m=r(951225),b=r(103670),x=r(762052),y=r(307257),v=r(309758),k=r(957716),j=r(634396),C=r(404827),w=r(963279);let S=1,I=(0,p.Wh)(()=>(0,c.eU)(null));function T({fileKey:e,fileId:t,isFoundryEnabled:r,surface:p,mode:S}){S=S??w.vq.FULL;let T=new URL((0,c.md)(j.jD)).host,_=(0,s.useRef)(new v.b({isFoundry:!0,surface:p})),N=(0,g.No)(),E=N.unwrapOr(null)?.key?.parentId||null,M=N.unwrapOr(null)?.tier,A=(0,s.useRef)(new m.w({surface:p,planTier:M})),O=(0,s.useRef)(new b.y),[D,P]=(0,s.useState)(!1),F=(0,k.hk)(),$=(0,s.useMemo)(()=>!!F,[F]),{user:L}=(0,x.$W)(F?.guid),z=(0,f.KP)(),R=!!L&&L.sessionID!==z,U=((0,y.ne)()?.size??0)>0,B=(0,s.useMemo)(()=>{let e=performance.getEntriesByType("navigation");return e.length>0&&e[0]?.type==="reload"},[]),[H,K]=(0,s.useState)(!1),G=function(){let[e,t]=(0,s.useState)(document.visibilityState);return(0,s.useEffect)(()=>{let e=()=>{t(document.visibilityState)};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[]),e}(),V=(0,s.useMemo)(()=>!D&&e&&r?{originHost:T,fileKey:e,logger:(0,w.gR)(),perfTracker:_.current,previewUpdateTracker:A.current,viteServerLifecycle:O.current,planTier:M,chatMessagesNodeGuid:F?.guid,mode:S}:null,[D,e,r,T,M,F?.guid,S]),[q,J]=(0,s.useState)(V?new w.Ay(V):null),X=(0,s.useCallback)(async()=>{q&&"visible"===document.visibilityState&&await q.recreateSandbox("user-hard-refresh")},[q]),Y=(0,s.useCallback)(()=>{q?.flushSandboxSyncer()},[q]),W=(0,h.q5)()?.canEdit;(0,s.useEffect)(()=>{if(r&&W&&1>(0,n.ft)()){let t=(0,n.ft)();o.l7.system("set-local-code-library-format",()=>{(0,n.lK)(1)}),e&&d.az.trackDefinedEvent("foundry.clf_upgrade",{fileKey:e,previousCodeLibraryFormat:t.toString(),newCodeLibraryFormat:"1"})}},[r,W,e]);let[Q,Z]=(0,c.fp)(I);(0,s.useEffect)(()=>{r||Z(null)},[r,Z]);let ee=(0,s.useCallback)(t=>{switch(t.state){case w.TT.PROVISIONING:Z({reinitialize:X,flushSandboxSyncer:Y,state:w.TT.PROVISIONING,perfTracker:_.current,previewUpdateTracker:A.current,viteServerLifecycle:O.current});break;case w.TT.CACHED_PREVIEW:Z({reinitialize:X,flushSandboxSyncer:Y,state:w.TT.CACHED_PREVIEW,cachedPreview:t.cachedPreview,perfTracker:_.current,previewUpdateTracker:A.current,viteServerLifecycle:O.current});break;case w.TT.REPROVISIONING:Z({reinitialize:X,flushSandboxSyncer:Y,state:w.TT.REPROVISIONING,reprovisioningReason:t.reprovisioningReason,perfTracker:_.current,previewUpdateTracker:A.current,viteServerLifecycle:O.current});break;case w.TT.PROVISIONED:A.current.setProvider(q?.provider),Z({reinitialize:X,flushSandboxSyncer:Y,state:w.TT.PROVISIONED,url:t.url,perfTracker:_.current,previewUpdateTracker:A.current,viteServerLifecycle:O.current,sandboxId:t.sandboxId});break;case w.TT.FAILED:{let r=(0,n.ft)();(0,l.getFeatureFlags)().make_foundry_disable_fallback_to_esbuild?Z({reinitialize:X,flushSandboxSyncer:Y,state:w.TT.FAILED,error:t.error.message,perfTracker:_.current,previewUpdateTracker:A.current,viteServerLifecycle:O.current}):(P(!0),Z(null),e&&d.az.trackDefinedEvent("foundry.fallback_to_esbuild",{fileKey:e,codeLibraryFormat:r.toString(),error:t.error.message,planTier:M,provider:q?.provider,multiplayerOnline:(0,u.eN)()}));break}default:(0,i.S9)(t,void 0,"Unknown sandbox state change")}},[q,e,Z,X,Y,M]),et=(0,s.useCallback)(e=>{q&&q.initializeCode(e)},[q]);return(0,s.useEffect)(()=>{q&&(q.attachHandlers({onStateChange:ee}),q.attachProperties({otherSessionRunningAgentLoop:R,designToCodeGenerating:U}))},[q,R,U,ee]),(0,s.useEffect)(()=>{V?q||J(new w.Ay(V)):J(null)},[V,q]),(0,s.useEffect)(()=>{q&&!q.initialized&&$&&"visible"===G&&(Z({reinitialize:X,flushSandboxSyncer:Y,state:w.TT.PROVISIONING,perfTracker:_.current,previewUpdateTracker:A.current,viteServerLifecycle:q.viteServerLifecycle}),q.initializeSandbox())},[q,$,Z,X,Y,G]),(0,s.useEffect)(()=>()=>{q?.destroy()},[q]),(0,s.useEffect)(()=>{!H&&q&&e&&(d.az.trackDefinedEvent("foundry.file_open",{fileKey:e,sourceCodeHash:(0,a.N)().getSourceCodeHash(),codeLibraryFormat:(0,n.ft)().toString(),surface:p,hardReloaded:B,planTier:M,provider:q?.provider}),d.az.trackDefinedEvent("foundry.session_context",{fileKey:e,fileKeyHash:(0,C.B5)(e),routingKey:(0,C.PK)(e)??void 0,fileId:t??void 0,userId:(0,C.WR)()??void 0,planParentId:E??void 0,planTier:M,provider:q?.provider}),K(!0))},[B,p,H,q,e,t,E,M]),(0,s.useMemo)(()=>null===Q&&!D&&r?{sandbox:{reinitialize:X,flushSandboxSyncer:Y,state:w.TT.PROVISIONING,perfTracker:_.current,previewUpdateTracker:A.current,viteServerLifecycle:O.current},setCodeReady:et}:{sandbox:Q,setCodeReady:et},[Q,D,r,et,X,Y])}},260587(e,t,r){r.d(t,{t:()=>n});var s=r(105652),a=r(239976);let n=(0,s.memo)(function(e){return(0,a.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M7.646 6.404a.5.5 0 0 1 .707 0l2.122 2.121a.5.5 0 0 1-.708.707L8 7.465 6.232 9.232a.5.5 0 0 1-.707-.707z"})})})},534399(e,t,r){r.d(t,{EY:()=>c,Qf:()=>o,gG:()=>l});var s=r(968922),a=r(359731);if(1464==r.j)var n=r(145758);var i=r(932858);function o(e,t){let r=(0,n.A)(e);return r?r.filter(e=>e.type!==a.K$p.TOOL_MESSAGE).reduce((e,r)=>{let n=r.type===a.K$p.ASSISTANT_MESSAGE,o=r.toolCalls.length>0,l=0===(0,s.H5)(r,t).plainText.length;if(n&&o&&l){let t=e[e.length-1];return t?.type===a.K$p.ASSISTANT_MESSAGE&&(t.toolCalls=i([...t.toolCalls,...r.toolCalls],"toolCallId")),e}return[...e,r]},[]):[]}function l(e){let{hidden:t,errors:r}=e;return!!t&&!!r&&r.length>0&&e.origin!==s.zm.FIX_ERRORS_BUTTON}function c(e){let t=e.slice().reverse().find(e=>e.type===a.K$p.USER_MESSAGE);return t?t.id:null}},323522(e,t,r){r.d(t,{N:()=>d,t:()=>c});var s=r(496059),a=r(833994),n=r(77691),i=r(667104),o=r(576145);if(1464==r.j)var l=r(836848);function c(e){let t=structuredClone(e);switch(t.type){case"text":case"reasoning":case"redacted-reasoning":return{...t,providerOptions:{}};case"selected-node-ids":case"enabled-libraries":case"jsx":case"cortex-request-uuid":case"code-chat-assistant-code":case"code-chat-assistant-text":case"code-chat-assistant-title":case"code-chat-model-config-version":case"code-chat-legacy-s3-code-snapshot":case"code-chat-errors":case"code-chat-library-keys":case"code-chat-origin":case"code-chat-legacy-assistant-tool-result":case"code-chat-snapshot-restore":case"code-chat-backfill-image-import":case"code-chat-backfill-diff-import":case"code-chat-backfill-inspected-element":return t;case"tool-call":{let{toolCallId:e,toolName:r,argsJSON:s,providerOptions:a}=t;return{type:"tool-call-json-DO-NOT-USE-IN-PROD",toolCallId:e,toolName:r,argsJson:s,providerOptions:a??{}}}case"tool-result":{let{toolCallId:e,toolName:r,resultJSON:s,isError:a}=t;return{type:"tool-result-json-DO-NOT-USE-IN-PROD",toolCallId:e,toolName:r,resultJson:s,isError:a,providerOptions:{}}}case"tool-result-ref":{let{toolCallId:e,toolName:r,isError:s}=t;return{type:"tool-result-ref",toolCallId:e,toolName:r,isError:s,providerOptions:{}}}case"code-chat-backfill-code-import":{let{codeFiles:e,...r}=t;return{...r,codeFiles:e??[]}}case"code-chat-provider-metadata":return{type:"code-chat-provider-metadata",providerMetadataJson:JSON.stringify(t.providerMetadata)};case"code-chat-code-import-ref":case"code-chat-image-import-ref":case"code-chat-diff-import-ref":case"code-chat-text-import-ref":case"code-chat-code-snapshot":return{type:t.type};case"code-chat-inspected-element-ref":{let{blobstoreContentKey:e,...r}=t;return r}case"code-chat-inspected-component":return{type:t.type,filePath:t.filePath,tagName:t.tagName};case"code-chat-inspected-library":return{type:t.type,folderPath:t.folderPath,libraryName:t.libraryName};case"code-chat-manual-edit":return{type:t.type,changedFilesJson:JSON.stringify(t.changedFiles),title:t.title,legacyS3CodeSnapshotKey:t.legacyS3CodeSnapshotKey};case"code-chat-duplicated-file":return{type:t.type,plainText:t.plainText,fileKeyHash:t.fileKeyHash};case"code-chat-inserted-template":return{type:t.type,plainText:t.plainText,legacyS3CodeSnapshotKey:t.legacyS3CodeSnapshotKey,blobstoreContentKey:t.blobstoreContentKey};case"code-chat-deleted-chat-history":return{type:t.type,timestamp:t.timestamp,userId:t.userId??""};case"code-chat-mcp-mention":return{type:t.type,mcpMentions:t.mcpMentions};case"image":throw new s.T(`Not implemented: Conversion from part type ${t.type} to protobuf not implemented`);default:(0,l.xb)(t)}}function d({type:e,contentJson:t,blobstoreContentKey:r}){if(!(0,i.pQ)(e))throw new s.T(`Unknown message part type: ${e}`);let c=n.l[e].fromJSON(t),d={type:e,...c};switch(d.type){case"text":case"reasoning":case"redacted-reasoning":case"selected-node-ids":case"enabled-libraries":case"jsx":case"cortex-request-uuid":case"code-chat-assistant-code":case"code-chat-assistant-title":case"code-chat-model-config-version":case"code-chat-legacy-s3-code-snapshot":case"code-chat-errors":case"code-chat-library-keys":case"code-chat-legacy-assistant-tool-result":case"code-chat-snapshot-restore":case"code-chat-duplicated-file":case"code-chat-inserted-template":case"code-chat-deleted-chat-history":case"code-chat-backfill-image-import":case"code-chat-backfill-code-import":case"code-chat-backfill-diff-import":case"code-chat-backfill-inspected-element":return d;case"code-chat-manual-edit":{let e,{title:t,changedFilesJson:r,legacyS3CodeSnapshotKey:n}=c;try{let t=JSON.parse(r);e=a.Op.shape.changedFiles.parse(t)}catch(t){let e=t instanceof Error?t.message:String(t);throw new s.T(`Invalid changedFiles for code-chat-manual-edit: ${e}`)}return{type:"code-chat-manual-edit",changedFiles:e,title:t,legacyS3CodeSnapshotKey:n,blobstoreContentKey:void 0}}case"code-chat-origin":{let{origin:e}=c,t=a.Iw.shape.origin.safeParse(e);if(!t.success)throw new s.T(`Invalid origin for code-chat-origin: ${e}`);return{type:"code-chat-origin",origin:t.data}}case"tool-call-json-DO-NOT-USE-IN-PROD":{let{toolCallId:e,toolName:t,argsJson:r,providerOptions:s}=c;return{type:"tool-call",toolCallId:e,toolName:t,argsJSON:r,providerOptions:s}}case"tool-result-json-DO-NOT-USE-IN-PROD":{let{toolCallId:e,toolName:t,resultJson:r,isError:s}=c;return{type:"tool-result",toolCallId:e,toolName:t,resultJSON:r,isError:s}}case"tool-result-ref":{if(!r)throw new s.T("Blobstore content key is required for tool-result-ref");let{toolCallId:e,toolName:t,isError:a}=c;return{type:"tool-result-ref",toolCallId:e,toolName:t,isError:a,blobstoreContentKey:r}}case"code-chat-assistant-text":{let{text:e,textMode:t}=c,r=o.w_.safeParse(t);if(!r.success)throw new s.T(`Invalid textMode for code-chat-assistant-text: ${t}`);if("code"===r.data)throw new s.T("Code mode messages should be represented by code-chat-assistant-code, not code-chat-assistant-text");return{type:"code-chat-assistant-text",text:e,textMode:r.data}}case"code-chat-provider-metadata":return{type:"code-chat-provider-metadata",providerMetadata:JSON.parse(c.providerMetadataJson)};case"code-chat-code-snapshot":if(!r)throw new s.T("Blobstore content key is required for code-chat-code-snapshot");return{type:"code-chat-code-snapshot",blobstoreContentKey:r};case"code-chat-image-import-ref":if(!r)throw new s.T("Blobstore content key is required for code-chat-image-import-ref");return{type:"code-chat-image-import-ref",blobstoreContentKey:r};case"code-chat-code-import-ref":if(!r)throw new s.T("Blobstore content key is required for code-chat-code-import-ref");return{type:"code-chat-code-import-ref",blobstoreContentKey:r};case"code-chat-diff-import-ref":if(!r)throw new s.T("Blobstore content key is required for code-chat-diff-import-ref");return{type:"code-chat-diff-import-ref",blobstoreContentKey:r};case"code-chat-text-import-ref":if(!r)throw new s.T("Blobstore content key is required for code-chat-text-import-ref");return{type:"code-chat-text-import-ref",blobstoreContentKey:r};case"code-chat-inspected-element-ref":{if(!r)throw new s.T("Blobstore content key is required for code-chat-inspected-element-ref");let{filePath:e,snippetStartLine:t,tagLine:a,tagName:n}=c;return{type:"code-chat-inspected-element-ref",filePath:e,snippetStartLine:t,tagLine:a,tagName:n,blobstoreContentKey:r}}case"code-chat-inspected-component":{let{filePath:e,tagName:t}=c;return{type:"code-chat-inspected-component",filePath:e,tagName:t}}case"code-chat-inspected-library":{let{folderPath:e,libraryName:t}=c;return{type:"code-chat-inspected-library",folderPath:e,libraryName:t}}case"code-chat-mcp-mention":{let{mcpMentions:e}=c;return{type:"code-chat-mcp-mention",mcpMentions:e}}case"text-ref":case"image-ref":case"reasoning-ref":case"redacted-reasoning-ref":case"tool-call-ref":case"figmake-test-part":throw new s.T(`Not implemented: Conversion from pb MessagePart type ${d.type} to AnyPart not implemented`);default:(0,l.xb)(d)}}}}]);

//# debugId=9287a61b-ea62-53bc-93e1-42a667689146

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/806e0053975af158840856f58cf1b9de448dd751/4411-9c5258711f8f8720.min.js.map